<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>NGII DEM 기반 지하수저류댐 유역 테스트</title>

  <!-- OpenLayers CSS/JS -->
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/ol@v7.1.0/ol.css">
  <script src="https://cdn.jsdelivr.net/npm/ol@v7.1.0/dist/ol.js"></script>

  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
    }
    #map {
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>
<div id="map"></div>

<script>
  // 1) 브이월드 API 키
  const vworldKey = "98574D34-73D4-351E-B16C-27513BD72D8D";  // ← 여기 태형 키 넣기

  // 2) 브이월드 배경지도 레이어 (2D Base 지도)
  const baseLayer = new ol.layer.Tile({
    source: new ol.source.XYZ({
      url:
        "https://api.vworld.kr/req/wmts/1.0.0/" +
        vworldKey +
        "/Base/{z}/{y}/{x}.png"
    })
  });

  // 3) WKMSBSN.geojson (유역 폴리곤) 벡터 레이어
  const basinLayer = new ol.layer.Vector({
    source: new ol.source.Vector({
      url: "WKMSBSN.geojson",           // 같은 폴더에 있다고 가정
      format: new ol.format.GeoJSON()
    }),
    style: new ol.style.Style({
      stroke: new ol.style.Stroke({
        width: 2
      }),
      fill: new ol.style.Fill({
        // 약간 투명한 채움
        color: "rgba(0, 0, 255, 0.1)"
      })
    })
  });

  // 4) 지도 생성
  const map = new ol.Map({
    target: "map",
    layers: [baseLayer, basinLayer],
    view: new ol.View({
      // 일단 대한민국 중간쯤
      center: ol.proj.fromLonLat([127.5, 36.0]),
      zoom: 7
    })
  });

  // 5) 유역 데이터가 로딩되면 extent에 맞게 화면 자동 맞추기
  basinLayer.getSource().on("change", function () {
    if (basinLayer.getSource().getState() === "ready") {
      const ext = basinLayer.getSource().getExtent();
      map.getView().fit(ext, {
        padding: [20, 20, 20, 20],
        maxZoom: 13
      });
    }
  });
</script>
</body>
</html>
